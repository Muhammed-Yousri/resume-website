<inserted from earlier canvas code>